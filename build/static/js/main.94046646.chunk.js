(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(e,t,n){e.exports=n.p+"static/media/bckgrnd.e97d3ed8.jpg"},241:function(e,t,n){e.exports=n(423)},417:function(e,t,n){},420:function(e,t,n){},423:function(e,t,n){"use strict";n.r(t);var a=n(20),r=n(0),i=n.n(r),o=n(25),c=n.n(o),l=n(427),u=n(429),s=n(428);n(246),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var m=Object(r.createContext)({currentUser:null,isAuth:!1,draft:null,mapTheme:"streets-v10",pins:[],currentPin:null}),d=n(162),p=n(21),g="LOGIN_USER",f="IS_LOGGED_IN",h="SIGNOUT_USER",v="SET_THEME",E="CREATE_DRAFT",b="UPDATE_DRAFT",y="REMOVE_DRAFT",j="GET_PINS",O="CREATE_PIN",x="SET_PIN",w="DELETE_PIN";function C(e,t){switch(t.type){case g:return Object(p.a)({},e,{currentUser:t.payload});case f:return Object(p.a)({},e,{isAuth:t.payload});case h:return Object(p.a)({},e,{isAuth:!1,currentUser:null});case v:return Object(p.a)({},e,{mapTheme:t.payload});case E:return Object(p.a)({},e,{currentPin:null,draft:{latitude:0,longitude:0}});case b:return Object(p.a)({},e,{draft:t.payload});case y:return Object(p.a)({},e,{draft:null});case j:return Object(p.a)({},e,{pins:t.payload});case O:var n=t.payload,a=e.pins.filter(function(e){return e._id!==n._id});return Object(p.a)({},e,{pins:[].concat(Object(d.a)(a),[n])});case x:return Object(p.a)({},e,{currentPin:t.payload,draft:null});case w:var r=e.pins.filter(function(e){return e._id!==t.payload._id});return Object(p.a)({},e,{pins:r,currentPin:null});default:return e}}var I=n(11),D=n(145),N=n.n(D),_=n(50),S=n.n(_),k=n(61),T=n.n(k),L=Object(I.createMuiTheme)({palette:{type:"dark",secondary:N.a,primary:{light:S.a[900],main:S.a[900],dark:S.a[900]}}});var A=function(e){return function(t){return i.a.createElement(I.MuiThemeProvider,{theme:L},i.a.createElement(T.a,null),i.a.createElement(e,t))}},M=n(62),P=n.n(M),R=n(63),U=n.n(R),z=n(147),F=n.n(z),G=n(28),$=n.n(G),W=n(146),Y=n.n(W),q=n(64),B=n.n(q),H=Object(I.withStyles)({root:{cursor:"pointer",display:"flex"},buttonText:{color:"orange",marginLeft:"10px"},buttonIcon:{marginLeft:"5px",color:"orange"}})(function(e){var t=e.classes,n=Object(r.useContext)(m).dispatch;return i.a.createElement(q.GoogleLogout,{onLogoutSuccess:function(){n({type:h})},render:function(e){var n=e.onClick;return i.a.createElement("span",{className:t.root,onClick:n},i.a.createElement(Y.a,{className:"logout"}))}})}),V=Object(I.withStyles)(function(e){return{root:{flexGrow:1},grow:{display:"flex",alignItems:"center"},right:{marginLeft:"auto",display:"flex",alignItems:"center"},icon:{marginRight:e.spacing.unit,color:"var(--main)",fontSize:45},mobile:{display:"none"},picture:{height:"50px",borderRadius:"90%",marginLeft:2*e.spacing.unit,marginRight:2*e.spacing.unit}}})(function(e){var t=e.classes,n=Object(r.useContext)(m).state.currentUser;return i.a.createElement("div",{className:t.root},i.a.createElement(P.a,{position:"static"},i.a.createElement(U.a,null,i.a.createElement("div",{className:t.grow},i.a.createElement(F.a,{className:t.icon}),i.a.createElement($.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0},"Susreti")),n&&i.a.createElement("div",{className:t.right},i.a.createElement($.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0},n.name),i.a.createElement("img",{src:n.picture,className:t.picture,alt:n.name}),i.a.createElement(H,null)))))}),J=n(22),Q=n.n(J),Z=n(33),K=n(38),X=n(65),ee=n.n(X),te=n(30),ne=n.n(te),ae=n(159),re=n.n(ae),ie=n(157),oe=n.n(ie),ce=n(158),le=n.n(ce),ue=n(156),se=n.n(ue),me=n(160),de=n.n(me),pe=n(66),ge={URL:"".concat(""),CLIENT_ID:"774156785777-6vliuclbbliomji2koo4j2lq56hndvie.apps.googleusercontent.com",MAP_TOKEN:"pk.eyJ1IjoiZGFydHh4cSIsImEiOiJjandjajI3MzUwZ3E4NDludWtmMGRyb25sIn0.egg5wrCe2G4aDyMfMZESCQ",IMG_CLOUD_NAME:"dqnzuius4",IMG_CLOUD_URL:"https://api.cloudinary.com/v1_1/dqnzuius4/image/upload",ADMIN_ID:"5cec67795ee37545bc543f6d"},fe=function(){var e=Object(r.useState)(""),t=Object(a.a)(e,2),n=t[0],i=t[1];return Object(r.useEffect)(function(){var e=window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().id_token;i(e)},[]),new pe.GraphQLClient("".concat(ge.URL,"/graphql"),{headers:{authorization:n}})},he=n(155),ve=n(31),Ee=n.n(ve),be=n(149),ye=n.n(be),je=Object(I.withStyles)(function(e){return{root:{display:"flex",marginTop:"150px",alignItems:"center",flexDirection:"column",justifyContent:"center"},icon:{margin:e.spacing.unit,fontSize:"80px",color:"var(--main)"}}})(function(e){var t=e.classes;return i.a.createElement("div",{className:t.root},i.a.createElement(ye.a,{className:t.icon}),i.a.createElement($.a,{noWrap:!0,component:"h2",variant:"h6",gutterBottom:!0},"Click on Map to ad a Pin"))}),Oe=n(150),xe=n.n(Oe),we=n(43),Ce=n.n(we),Ie=n(152),De=n.n(Ie),Ne=n(151),_e=n.n(Ne),Se=n(153),ke=n.n(Se),Te=n(154),Le=n.n(Te),Ae=Object(I.withStyles)(function(e){return{form:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingBottom:e.spacing.unit,marginTop:"20px"},contentField:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit,width:"95%"},input:{display:"none"},alignCenter:{display:"flex",alignItems:"center"},iconLarge:{fontSize:40,marginRight:e.spacing.unit},leftIcon:{fontSize:20,marginRight:e.spacing.unit},rightIcon:{fontSize:20,marginLeft:e.spacing.unit},button:{marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit,marginRight:e.spacing.unit,marginLeft:0},textField:{width:"100 %"}}})(function(e){var t=e.classes,n=Object(r.useContext)(m),o=n.state,c=n.dispatch,l=Object(r.useState)(""),u=Object(a.a)(l,2),s=u[0],d=u[1],p=Object(r.useState)(""),g=Object(a.a)(p,2),f=g[0],h=g[1],v=Object(r.useState)(""),E=Object(a.a)(v,2),b=E[0],j=E[1],x=Object(r.useState)(""),w=Object(a.a)(x,2),C=w[0],I=w[1],D=Object(r.useState)(!1),N=Object(a.a)(D,2),_=N[0],S=N[1],k=fe(),T=function(){var e=Object(Z.a)(Q.a.mark(function e(t){var n,a,r,i,l,u,m;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),S(!0),n=o.draft,a=n.latitude,r=n.longitude,e.next=6,A();case 6:return i=e.sent,l={title:s,content:b,image:i,latitude:a,longitude:r,eventDate:C},e.next=10,k.request("\n  mutation(\n    $title: String!,\n    $image: String!,\n    $content: String!,\n    $latitude: Float!,\n    $longitude: Float!,\n    $eventDate: String!,\n    ) {\n      createPin(input: {\n        title: $title,\n        image: $image,\n        content: $content,\n        latitude: $latitude,\n        longitude: $longitude,\n        eventDate: $eventDate\n      }) {\n        _id\n        createdAt\n        title\n        content\n        image\n        latitude\n        longitude\n        eventDate\n        author {\n          _id\n          name\n          email\n          picture\n        }\n      }\n    }\n",l);case 10:u=e.sent,m=u.createPin,c({type:O,payload:m}),L(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),S(!1),console.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[0,16]])}));return function(t){return e.apply(this,arguments)}}(),L=function(){d(""),h(""),j(""),c({type:y})},A=function(){var e=Object(Z.a)(Q.a.mark(function e(){var t,n;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("file",f),t.append("upload_preset","airsoft"),t.append("cloud_name",ge.IMG_CLOUD_NAME),e.next=6,xe.a.post(ge.IMG_CLOUD_URL,t);case 6:return n=e.sent,e.abrupt("return",n.data.url);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();return i.a.createElement("form",{className:t.form},i.a.createElement($.a,{className:t.alignCenter,component:"h2",variant:"h4",color:"secondary"},i.a.createElement(_e.a,{className:t.iconLarge}),"Pin Location"),i.a.createElement("div",null,i.a.createElement(Ce.a,{name:"title",label:"title",placeholder:"Dodaj Title",onChange:function(e){return d(e.target.value)}}),i.a.createElement("input",{type:"file",accept:"image/*",id:"image",className:t.input,onChange:function(e){return h(e.target.files[0])}}),i.a.createElement("label",{htmlFor:"image"},i.a.createElement(ne.a,{component:"span",size:"small",style:{color:f&&"#c6ff00"},className:t.button},i.a.createElement(De.a,null))),i.a.createElement("div",{className:t.contentField},i.a.createElement(Ce.a,{name:"content",label:"Content",multiline:!0,rows:"6",margin:"normal",fullWidth:!0,variant:"outlined",placeholder:"Dodaj Title",onChange:function(e){return j(e.target.value)}})),i.a.createElement("div",null,i.a.createElement(Ce.a,{id:"eventDate",label:"Vreme Susreta",type:"datetime-local",defaultValue:ee()(new Date,"YYYY-MM-DDTHH:mm"),className:t.textField,onChange:function(e){return I(e.target.value)},InputLabelProps:{shrink:!0}})),i.a.createElement("div",null,i.a.createElement(ne.a,{component:"span",color:"primary",size:"small",variant:"contained",className:t.button,onClick:L},i.a.createElement(ke.a,{className:t.leftIcon}),"Discard"),i.a.createElement(ne.a,{type:"submit",component:"span",color:"secondary",size:"small",variant:"contained",className:t.button,disabled:!s.trim()||!b.trim()||!f||_,onClick:T},"Submit",i.a.createElement(Le.a,{className:t.rightIcon})))))}),Me=Object(I.withStyles)(function(e){return{root:{padding:"1em 0.5em",textAlign:"center",width:"100%"},icon:{marginLeft:e.spacing.unit,marginRight:e.spacing.unit},text:{display:"flex",alignItems:"center",justifyContent:"center"}}})(function(e){e.classes;return i.a.createElement("div",null,"PinContent")}),Pe=Object(I.withStyles)({root:{minWidth:350,maxWidth:400,maxHeight:"calc(100vh - 64px)",overflowY:"scroll",display:"flex",flexDirection:"column",justifyContent:"center",backgroundColor:"#323232"},footer:{marginTop:"auto"},rootMobile:{maxWidth:"100%",maxHeight:300,overflowX:"hidden",overflowY:"scroll"}})(function(e){var t,n=e.classes,a=Object(r.useContext)(m),o=a.state,c=a.dispatch,l=o.draft,u=o.mapTheme,s=o.currentPin;l||s||(t=je),l&&!s&&(t=Ae),!l&&s&&(t=Me),Object(r.useEffect)(function(){d()},[]);var d=function(){var e=localStorage.getItem("theme");e&&c({type:v,payload:e})},p=function(e){var t;c({type:v,payload:e.target.value}),t=e.target.value,localStorage.setItem("theme",t)};return i.a.createElement(he.a,{className:n.root},i.a.createElement(t,null),i.a.createElement("div",{className:"blog-footer"},i.a.createElement("p",null,"Set Theme for map"),i.a.createElement(Ee.a,{checked:"streets-v10"===u,onChange:p,value:"streets-v10",name:"radio-button-demo","aria-label":"A"}),i.a.createElement(Ee.a,{checked:"outdoors-v10"===u,onChange:p,value:"outdoors-v10",name:"radio-button-demo","aria-label":"B"}),i.a.createElement(Ee.a,{checked:"light-v9"===u,onChange:p,value:"light-v9",name:"radio-button-demo","aria-label":"C"}),i.a.createElement(Ee.a,{checked:"dark-v9"===u,onChange:p,value:"dark-v9",name:"radio-button-demo","aria-label":"D"}),i.a.createElement(Ee.a,{checked:"satellite-v9"===u,onChange:p,value:"satellite-v9",name:"radio-button-demo","aria-label":"E"}),i.a.createElement(Ee.a,{checked:"satellite-streets-v10"===u,onChange:p,value:"satellite-streets-v10",name:"radio-button-demo","aria-label":"F"})))}),Re={latitude:45.00521,longitude:19.816196,zoom:7},Ue=Object(I.withStyles)({root:{display:"flex"},rootMobile:{display:"flex",flexDirection:"column-reverse"},navigationControl:{position:"absolute",top:0,left:0,margin:"1em"},deleteIcon:{color:"red"},popupImage:{padding:"0.4em",height:200,width:"100%",maxWidth:"320px",objectFit:"cover"},popupTab:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}})(function(e){var t=e.classes,n=fe(),o=Object(r.useContext)(m),c=o.state,l=o.dispatch;Object(r.useEffect)(function(){_()},[]);var u=Object(r.useState)(Re),s=Object(a.a)(u,2),d=s[0],g=s[1],f=Object(r.useState)(null),h=Object(a.a)(f,2),v=h[0],y=h[1],O=c.mapTheme;Object(r.useEffect)(function(){S()},[]);var C=Object(r.useState)(null),I=Object(a.a)(C,2),D=I[0],N=I[1],_=function(){var e=Object(Z.a)(Q.a.mark(function e(){var t,a;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.request("\n{\n  getPins {\n    _id\n    createdAt\n    title\n    content\n    image\n    latitude\n    longitude\n    eventDate\n    author {\n      _id\n      name\n      email\n      picture\n    }\n    comments {\n      text\n      createdAt\n      author {\n        _id\n        name\n        email\n        picture\n      }\n    }\n  }\n}\n");case 2:t=e.sent,a=t.getPins,l({type:j,payload:a});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),S=function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(e){var t=e.coords,n=t.latitude,a=t.longitude;g(Object(p.a)({},d,{latitude:n,longitude:a})),y({latitude:n,longitude:a})})},k=function(){var e=Object(Z.a)(Q.a.mark(function e(t){var a,r,i;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={pinId:t._id},e.next=3,n.request("\n  mutation($pinId: ID!) {\n    deletePin(pinId: $pinId) {\n      _id\n    }\n  }\n",a);case 3:r=e.sent,i=r.deletePin,l({type:w,payload:i}),N(null);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),T=function(e){var t=function(e){var t=Math.round(Math.abs((new Date(1*e.eventDate).getTime()-(new Date).getTime())/864e5));return new Date(1*e.eventDate)<new Date?"--light":t<=7?"var(--main)":"var(--focus)"}(e);return i.a.createElement(K.a,{key:e._id,latitude:e.latitude,longitude:e.longitude,offsetLeft:-19,offsetTop:-37},i.a.createElement(le.a,{onClick:function(){return function(e){N(e),l({type:x,payload:e})}(e)},style:{fontSize:40,color:t}}))};return i.a.createElement("div",{className:t.root},i.a.createElement(K.d,Object.assign({mapboxApiAccessToken:ge.MAP_TOKEN,width:"100vw",height:"calc(100vh - 64px)",mapStyle:"mapbox://styles/mapbox/".concat(O),onViewportChange:function(e){return g(e)},onClick:function(e){var t=e.lngLat,n=e.leftButton;if(console.log(t,n),n){c.draft||l({type:E});var r=Object(a.a)(t,2),i=r[0],o=r[1];l({type:b,payload:{longitude:i,latitude:o}})}}},d),i.a.createElement("div",{className:t.navigationControl},i.a.createElement(K.b,{onViewportChange:function(e){return g(e)}})),v&&i.a.createElement(K.a,{latitude:v.latitude,longitude:v.longitude,offsetLeft:-19,offsetTop:-37},i.a.createElement(se.a,{style:{fontSize:40,color:"var(--white)"}})),c.draft&&i.a.createElement(K.a,{latitude:c.draft.latitude,longitude:c.draft.longitude,offsetLeft:-19,offsetTop:-37},i.a.createElement(oe.a,{style:{fontSize:40,color:"var(--focus)"}})),c.pins&&c.pins.map(function(e){return T(e)}),D&&i.a.createElement(K.c,{anchor:"top",latitude:D.latitude,longitude:D.longitude,closeOnClick:!1,onClose:function(){return N(null)}},i.a.createElement("img",{className:t.popupImage,src:D.image,alt:D.title}),i.a.createElement("div",{className:"popup-style"},i.a.createElement("h4",null,D.title),i.a.createElement("p",{className:"popup-label"},"Date"),i.a.createElement("p",null,ee()(new Date(1*D.eventDate),"MM/DD/YYYY/hh:m")),i.a.createElement("p",{className:"popup-label"},"Coordinates"),i.a.createElement("p",null,D.latitude.toFixed(6)," - ",D.longitude.toFixed(6)),i.a.createElement("div",{className:"popup-footer"},(console.log(c.currentUser._id,ge.ADMIN_ID),(c.currentUser._id===D.author._id||c.currentUser._id===ge.ADMIN_ID)&&i.a.createElement(ne.a,{onClick:function(){return k(D)}},i.a.createElement(re.a,{className:t.deleteIcon}))),i.a.createElement(ne.a,{component:"span",color:"primary",size:"small"},i.a.createElement(de.a,{className:t.deleteIcon,onClick:function(){return N(null)}})))))),i.a.createElement(Pe,null))}),ze=A(function(){return i.a.createElement("div",null,i.a.createElement(V,null),i.a.createElement(Ue,null))}),Fe=n(426),Ge=(n(417),n(161)),$e={root:{height:"100vh",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",backgroundImage:"linear-gradient(0deg, rgba(2, 2, 2, 0.9) 0%, rgba(255,255,255,.3) 70%), url(".concat(n.n(Ge).a,")"),backgroundSize:"cover"}},We=Object(I.withStyles)($e)(function(e){var t=e.classes,n=Object(r.useContext)(m).dispatch,a=function(){var e=Object(Z.a)(Q.a.mark(function e(t){var a,r,i,c;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.getAuthResponse().id_token,r=new pe.GraphQLClient("".concat(ge.URL,"/graphql"),{headers:{authorization:a}}),e.next=5,r.request("\n{\n  me {\n    _id\n    name\n    email\n    picture\n    admin\n  }\n}\n");case 5:i=e.sent,c=i.me,n({type:g,payload:c}),n({type:f,payload:t.isSignedIn()}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),o(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t){return e.apply(this,arguments)}}(),o=function(e){return console.error(e)};return i.a.createElement("div",{className:t.root},i.a.createElement("div",{className:"login-wrap"},i.a.createElement("div",{className:"login"},i.a.createElement("h2",{className:"login__header"},"Airsoft ",i.a.createElement("span",null,"Susreti")),i.a.createElement("p",{className:"login__subheader"},"Spisak Airsoft susreta"),i.a.createElement(B.a,{clientId:ge.CLIENT_ID,buttonText:"Login with your Gmail",onSuccess:a,onFailure:o,theme:"Light",isSignedIn:!0}))))}),Ye=function(){return Object(r.useContext)(m).state.isAuth?i.a.createElement(Fe.a,{to:"/"}):i.a.createElement(We,null)},qe=n(163),Be=function(e){var t=e.component,n=Object(qe.a)(e,["component"]),a=Object(r.useContext)(m).state;return i.a.createElement(s.a,Object.assign({},n,{render:function(e){return a.isAuth?i.a.createElement(t,e):i.a.createElement(Fe.a,{to:"/login"})}}))};n(420);c.a.render(i.a.createElement(function(){var e=Object(r.useContext)(m),t=Object(r.useReducer)(C,e),n=Object(a.a)(t,2),o=n[0],c=n[1];return console.log(o),i.a.createElement(l.a,null,i.a.createElement(m.Provider,{value:{state:o,dispatch:c}},i.a.createElement(u.a,null,i.a.createElement(Be,{exact:!0,path:"/",component:ze}),i.a.createElement(s.a,{path:"/login",component:Ye}))))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[241,2,1]]]);
//# sourceMappingURL=main.94046646.chunk.js.map